app-id: org.purei.Play
runtime: org.kde.Platform
runtime-version: 5.15-22.08
sdk: org.kde.Sdk
command: Play
finish-args:
  - --share=ipc
  - --share=network
  - --socket=x11
  - --filesystem=home:ro
  - --filesystem=/mnt:ro
  - --filesystem=/media:ro
  - --filesystem=/run/media:ro
  - --device=all
  - --socket=pulseaudio
modules:
  - shared-modules/glu/glu-9.json
  - name: evdev
    config-opts:
      - --disable-static
    cleanup:
      - /bin
      - /include
      - /lib/pkgconfig
      - /lib/*.la
      - /share/man
    sources:
      - type: archive
        url: https://www.freedesktop.org/software/libevdev/libevdev-1.13.0.tar.xz
        sha256: 9edf2006cc86a5055279647c38ec923d11a821ee4dc2c3033e8d20e8ee237cd9
        x-checker-data:
          type: anitya
          project-id: 20540
          stable-only: true
          url-template: https://www.freedesktop.org/software/libevdev/libevdev-$version.tar.xz
  - name: Play!
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
    build-options:
      arch:
        aarch64:
          config-opts:
            - -DCMAKE_BUILD_TYPE=RelWithDebInfo
            - -DUSE_GLES=yes
    post-install:
      - |
        GIT_VERSION=$(git describe --always);
        GIT_DATE=$(git show -s --format=%cs);
        sed -i 's|<releases>|<releases>\n    <release date="'${GIT_DATE}'" version="'${GIT_VERSION}'"/>|' ${FLATPAK_DEST}/share/metainfo/org.purei.Play.metainfo.xml;
    sources:
      - type: git
        url: https://github.com/jpd002/Play-.git
        branch: master
        commit: d2eba758db11a6890e1be43a898e1853c7875541
        disable-shallow-clone: true
